---
title: "How to Run Windows Update with PowerShell"
date: 2021-07-27T07:39:58+07:00
toc: false
images:
tags: [ "windows", "powershell", "windows update" ]
---

‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏ô‡∏µ‡πâ WFH ‡πÅ‡∏ö‡∏ö 100% ‡πÅ‡∏•‡∏∞ VPN client ‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏•‡∏á antivirus ‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï signature ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÄ‡∏™‡∏°‡∏≠ ‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÑ‡∏î‡πâ

‡πÇ‡∏î‡∏¢‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß ‡∏ú‡∏°‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ 3<sup>rd</sup> party antivirus ‡∏°‡∏≤‡∏û‡∏±‡∏Å‡πÉ‡∏´‡∏ç‡πà‡πÜ ‡πÅ‡∏•‡πâ‡∏ß ([‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏](/posts/red-x-blue-pill-2019/#breaking-scada-and-anti-virus-for-fun--profit) üòÖ) ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô antivirus ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ Microsoft Defender ‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏°‡∏≤‡∏Å‡∏±‡∏ö Windows 10 ‡∏ô‡∏µ‡πà‡πÅ‡∏´‡∏•‡∏∞

‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡∏°‡∏à‡∏∞‡∏ï‡πà‡∏≠ VPN ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà Settings > Update & Security ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡∏Å‡∏î Check for updates ‡∏ã‡∏∂‡πà‡∏á‡∏û‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏ö‡πà‡∏≠‡∏¢‡πÜ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡πá‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏ß‡πà‡∏≤‡∏°‡∏±‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡πÄ‡∏ß‡∏•‡∏≤ ‡∏ô‡πà‡∏≤‡∏à‡∏∞‡∏°‡∏µ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏ö‡∏ö‡∏Å‡∏î‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏´‡πâ‡∏ß‡∏¥‡∏ô‡πÇ‡∏î‡∏ß‡∏™‡πå check ‡πÅ‡∏•‡∏∞ install update ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ üòë ‡∏û‡∏≠‡∏•‡∏≠‡∏á Google ‡∏î‡∏π‡∏Å‡πá‡∏û‡∏ö‡∏ß‡πà‡∏≤ PowerShell ‡∏°‡∏±‡∏ô‡∏ó‡∏≥‡∏™‡∏¥‡πà‡∏á‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡πÇ‡∏°‡∏î‡∏π‡∏• [PSWindowsUpdate](https://www.powershellgallery.com/packages/PSWindowsUpdate/) 

‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á ‡∏Å‡πá‡∏£‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ô‡∏µ‡πâ‡πÉ‡∏ô Elevated PowerShell (run as Administrator)

```powershell
Install-Module -Name PSWindowsUpdate
```

‡∏™‡πà‡∏ß‡∏ô‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏´‡∏≤‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡∏à‡∏≤‡∏Å Google ‡πÅ‡∏ï‡πà‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏á‡∏°‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏≤‡∏ô‡∏ô‡∏ô ‡∏Ñ‡∏∑‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ option ‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏∞**‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞ patch ‡∏Ç‡∏≠‡∏á Microsoft Defender** (‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô update ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ú‡∏°‡∏≠‡∏¢‡∏≤‡∏Å‡∏à‡∏∞‡∏≠‡πà‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡πà‡∏≤‡∏°‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£ ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠ VPN) ‡∏´‡∏≤‡πÑ‡∏õ‡∏´‡∏≤‡∏°‡∏≤‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á ‡∏Å‡πá‡∏û‡∏ö‡∏ß‡πà‡∏≤‡∏≠‡πà‡∏≤‡∏ô help ‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏ö‡∏™‡∏∏‡∏î ü§£ ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á

```powershell
Get-Help Get-WindowsUpdate -Full
```

‡∏•‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏ã‡∏±‡∏Å‡∏û‡∏±‡∏Å‡∏Å‡πá‡∏û‡∏ö‡∏ß‡πà‡∏≤‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏≠

```powershell
Get-WindowsUpdate -Install -WindowsUpdate -Category 'Definition Updates' -AcceptAll
```

‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏Å‡πá‡πÅ‡∏Ñ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á batch file ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏£‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏Ç‡πâ‡∏≤‡∏á‡∏ö‡∏ô ‡∏≠‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ú‡∏°‡πÉ‡∏ä‡πâ [PowerShell](https://github.com/PowerShell/PowerShell) ‡∏ï‡∏±‡∏ß‡πÉ‡∏´‡∏°‡πà ‡∏ñ‡πâ‡∏≤‡∏´‡∏≤‡∏Å‡πÉ‡∏Ñ‡∏£‡πÉ‡∏ä‡πâ Windows PowerShell ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤ ‡∏Å‡πá‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô `pwsh` ‡πÄ‡∏õ‡πá‡∏ô `powershell` ‡πÅ‡∏ó‡∏ô üôÉ

```cmd
@echo off
pwsh -ExecutionPolicy bypass -NoProfile -Command "& Get-WindowsUpdate -Verbose -Install -WindowsUpdate -Category 'Definition Updates' -AcceptAll"
pause
```
